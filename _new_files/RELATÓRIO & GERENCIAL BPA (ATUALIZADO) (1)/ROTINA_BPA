Attribute VB_Name = "ROTINA_BPA"
Option Explicit
Public Const NameApp As String = "Planilha de Consultas BPA"
Public iVal           As Integer
Public Sub ERASE_DATA()
    Dim ws      As Worksheet
'    Dim iVal    As Integer
      
    Set ws = shDados
      
    With ws
        .Range("A6").Select
        If .Range("A6").Value = vbNullString Then
            MsgBox "Não há dados.", vbExclamation, NameApp
            Exit Sub
                   
        Else
            If .Range("A7").Value = vbNullString Then
                .Range("A6", "B6").ClearContents
                Exit Sub
                        
            Else
      
                If .Range("A8").Value = vbNullString Then
                    .Range("A7", Range("A7").End(xlToRight)).Rows.Delete
                    .Range("A6", "B6").ClearContents
                    Exit Sub
                Else
                    iVal = MsgBox("Muitos dados serão apagados, tem certeza que deseja limpá-los?", vbExclamation + vbYesNo, NameApp)
                    If iVal = vbYes Then
                        .Range(Range("A7", Range("A7").End(xlToRight)), Range("A7", Range("A7").End(xlDown))).Rows.Delete
                        .Range("A6", "B6").ClearContents
                        Exit Sub
                    Else
                        MsgBox "Operação Cancelada", vbCritical, NameApp
                        Exit Sub
                    End If
                End If
            End If
        End If
    End With
    
    Set ws = Nothing
    iVal = 0
End Sub

Public Sub PrintSheet()

'    Dim iVal    As Integer

    If shDados.Range("A6").Value = vbNullString Then
        MsgBox "Não há dados para impressão.", vbExclamation, NameApp
        Exit Sub
    Else
        iVal = MsgBox("A planilha será salva e o relatório com os dados digitados será impresso na impressora padrão configurada neste computador." & _
                      vbNewLine & vbNewLine & "Deseja prosseguir?", vbInformation + vbYesNo, NameApp)
          
        If iVal = vbYes Then
            twbk.Save
            Application.ScreenUpdating = False
            With shDyn
                .Activate
                .PivotTables("UPLOAD_BPA").PivotCache.Refresh
                .PrintOut
            End With
            shDados.Activate
            MsgBox "O relatório atualizado foi enviado para a fila de impressão da impressora padrão!" & vbNewLine & vbNewLine & "Verifique o arquivo impresso.", vbInformation, NameApp
            Application.ScreenUpdating = True
        Else
            MsgBox "Operação Cancelada", vbCritical, NameApp
            Exit Sub
        End If
     End If
     
     iVal = 0
End Sub

